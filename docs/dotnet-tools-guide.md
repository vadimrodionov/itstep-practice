# .NET CLI

[Назад к содержанию](./index.md)

## Предисловие - краткий гайд по использованию консоли в примерах

> *Все представленные ниже команды работают в `Powershell`.*

### Навигация

- `ls` - просмотр содержимого текущего каталога
- `ls sample` - просмотр содержимого подкаталога `sample`
- `ls c:/users` - просмотр содержимого каталога `C:\Users\`
- `ls c:\users` - см. выше
- `cd` - смена текущего каталога
- `cd .` - переход к текущему каталогу
- `cd ..` - переход к каталогу на один уровень выше
- `cd c:` - переход к корню диска `C:`
- `cd sample` - переход к подкаталогу `sample` текущего каталога
- `cd ../sample` - переход к подкаталогу `sample` каталога на один уровень 
  выше текущего
- `cd ~` - переход к корневому каталогу пользователя 
  (e.g. `C:\Users\Vasily.Pupkin`)
- `cd ./"John Doe"` - переход к подкаталогу `John Doe`, содержащему в своём 
  имени пробел
- `cd "./John Doe"` - см. выше
- `cd './John Doe'` - см. выше
- `cd ./'John Doe'` - см. выше

### Работа с файлами

- `cat temp.txt` - вывесть содержимое файла `temp.txt` в консоль
- `new-item temp.txt` - создать файл `temp.txt`
- `mv temp.txt sample.txt` - переименовать `temp.txt` в `sample.txt`
- `mv temp.txt sample` - переместить `temp.txt` в каталог `sample`
- `mv temp.txt sample` - переместить `temp.txt` в каталог `sample`
- `mv sample/temp.txt .` - переместить `temp.txt` из каталога `sample` 
  в текущий каталог
- `mv temp.txt sample/sample.txt` - переместить `temp.txt` в каталог `sample` 
  и переименовать в `sample.txt`
- `mv sample temp` - переместить каталог `sample` в каталог `temp`, если 
  `temp` существует, или переименовать `sample` в `temp`
- `cp temp.txt sample.txt` - копировать `temp.txt` в `sample.txt`
- `rm temp.txt` - удалить `temp.txt`
- `rm deleted` - удалить подкаталог `deleted`
- `rm -r deleted` - удалить подкаталог `deleted` со всем содержимым
- `mkdir sample` - создать каталог `sample`
- `rmdir sample` - удалить каталог `sample`

### Прочие полезности

- `clear` - очистить консоль
- `exit` - закрыть консоль
- `explorer .` - открыть Проводник в текущем каталоге
- `notepad .\temp.txt` - открыть `temp.txt` с помощью NotePad
- `.\MyPetProject.sln` - открыть `MyPetProject.sln` из текущего каталога с 
  помощью приложения по умолчанию (для `.sln`- и `.csproj`-файлов - 
  Visual Studio)
- `code .` - запуск редактора `Visual Studio Code` в текущем каталоге
  (если установлен)
- нажатие `Tab` - автодополнение (удобно использовать, чтобы не набирать 
  длинные названия каталогов/файлов)


## Что такое .NET CLI и зачем оно нужно? Обзор

.NET CLI - набор инструментов для разных операций внутри процесса разработки
приложений. Позволяет создавать файлы из шаблонов, собирать, тестировать, 
запускать и развёртывать проекты, управлять зависимостями и кучу других 
полезностей. Имеет возможность расширения.

## С чего начать? Установка

.NET CLI входит в .NET SDK, поставляемый вместе с Visual Studio, поэтому 
отдельная установка не требуется.

Проверить установленную версию можно командой `dotnet --version`.

> Нам потребуется версия 5.x, если ваша версия ниже - нужно установить 
> [.NET 5 SDK](https://dotnet.microsoft.com/download/dotnet/5.0)

## Сценарии использования

### Использование шаблонов

.NET CLI позволяет создавать файлы, проекты или решения по предустановленным
шаблонам.

Для создания артефактов из шаблона используется команда `dotnet new`:
``` .NET CLI
dotnet new console
```
В результате выполнения примера выше будет создано консольное приложение по 
шаблону `console`.

При создании можно указать имя проекта с помощью опции `-n`: 
`dotnet new console -n ConsoleAppSample`.

Также можно указать путь к каталогу, по которому будут созданы артефакты, 
с помощью опции `-o`: 
`dotnet new console -n ConsoleAppSample -o src/samples/console-app`.

Просмотреть список доступных шаблонов можно с помощью `dotnet new -l`.

### Установка шаблонов

Помимо доступных по умолчанию шаблонов, .NET CLI позволяет устанавливать 
шаблоны из различных источников в виде NuGet-пакетов. 

> ***`NuGet`-пакеты, что?***
>
> `NuGet` - менеджер пакетов для экосистемы .NET. Менеджер пакетов нужен для
> удобного управления зависимостями. С его помощью к приложению можно легко 
> подключать любые версии любых требуемых библиотек. Аналогичные штуки есть 
> для экосистем вокруг других языков программирования (`npm` и `yarn` для 
> Node.js, `pip` для Python, `gem` для Ruby, etc.), для операционных систем
> (`apt` и `dpkg` для Ubuntu/Debian, `rpm` и `yum` для RedHat, etc.)
> 
> Пакеты хранятся в специальных репозиториях, доступных по сети. Основным 
> репозиторием является [nuget.org](https://www.nuget.org/), кроме него есть 
> другие публичные и приватные репозитории.
> 
> Шаблоны для `dotnet new` поставляются в виде специальных `NuGet`-пакетов,
> хранящихся наряду с другими пакетами в этих репозиториях.

Для установки пакета шаблонов нужно выполнить команду `dotnet new -i`.
Например, `dotnet new -i NUnit3.DotNetNew.Template` установит пакет шаблонов
для тестовых проектов, использующих фреймворк `NUnit`.

Для установки пакетов из других репозиториев нужно указать адрес репозитория 
с помощью опции `--nuget-source`:
`dotnet new -i NUnit3.DotNetNew.Template --nuget-source https://api.nuget.org/v3/index.json`

Для просмотра установленных пакетов используется опция `-u`:
`dotnet new -u`

Для удаления пакета используется опция `-u` с указанием имени пакета:
`dotnet new -u NUnit3.DotNetNew.Template`

[Документация `dotnet new`](https://docs.microsoft.com/en-us/dotnet/core/tools/dotnet-new)

### Сборка

Собирать исходный код проектов в исполняемые файлы можно с помощью команды
`dotnet build`. 

[Документация `dotnet build`](https://docs.microsoft.com/en-us/dotnet/core/tools/dotnet-build)

### Тестирование

Запускать автоматическое тестирование для решений можно с помощью 
`dotnet test`.

[Документация `dotnet test`](https://docs.microsoft.com/en-us/dotnet/core/tools/dotnet-test)

### Запуск

Запускать проекты можно с помощью команды `dotnet run`. При выполнении без 
параметров будет запущен проект из текущего каталога.

Команда позволяет указывать путь к проекту с помощью опции `-p`:
`dotnet run -p ./src/sample/sample.csproj`

Чтобы передать в запускаемое приложение аргументы командной строки, 
используется опция `--`:
`dotnet run -- -h` - передаст параметр `-h` в запускаемое приложение. 

[Документация `dotnet run`](https://docs.microsoft.com/en-us/dotnet/core/tools/dotnet-run)

### Развёртывание

Сборка приложения для публикации выполняется с помощью `dotnet publish`.
Упаковка проекта в NuGet-пакет выполняется с помощью `dotnet pack`.

[Документация `dotnet publish`](https://docs.microsoft.com/en-us/dotnet/core/tools/dotnet-publish)
[Документация `dotnet pack`](https://docs.microsoft.com/en-us/dotnet/core/tools/dotnet-pack)

### Восстановление зависимостей

Команда `dotnet restore` позволяет восстановить зависимости проекта. 
Используется неявно при выполнении других команд (`build`, `test`, `run`, etc.)
Может быть полезна, когда нужно явно контролировать время восстановления 
зависимостей, например, в системах автоматической сборки и развёртывания.

[Документация `dotnet restore`](https://docs.microsoft.com/en-us/dotnet/core/tools/dotnet-restore)


## Как это поможет нам в процессе обучения?

Для каждого урока будет шаблон решения с уже созданными пустыми проектами
под ваши задания. Шаблонизация поможет сэкономить время на создание проектов
и стандартизировать структуру решения, чтобы облегчить проверку.

Чек-лист выполнения практических и домашних заданий с шаблонами:
1. Устанавливаем .NET CLI, если ещё не;
1. Устанавливаем пакет с шаблонами: `dotnet new -i ITStep.CSharp.Templates`;
1. Создаём решение для заданий урока: 
   `dotnet new itstep-cs-lessonX -n VasilyPupkin`,
   где `X` меняем на номер урока, а `VasilyPupkin` - на ваше имя;
1. Открываем решение проект и решаем задачки в соответствующих проектах.

